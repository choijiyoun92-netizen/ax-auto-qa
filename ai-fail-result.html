<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>AI QA Platform – QA 실행 결과</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <style>
    * { box-sizing: border-box; }

    body {
      margin: 0;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
      background: #f4f6f9;
      color: #222;
    }

    header {
      background: #ffffff;
      padding: 16px 24px;
      border-bottom: 1px solid #e5e7eb;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    header h1 {
      font-size: 18px;
      margin: 0;
    }

    header span {
      font-size: 13px;
      color: #dc2626;
      font-weight: 600;
    }

    .step-bar {
      max-width: 960px;
      margin: 24px auto 0;
      padding: 0 20px;
      display: flex;
      gap: 12px;
    }

    .step-item {
      flex: 1;
      padding: 10px 12px;
      border-radius: 999px;
      text-align: center;
      font-size: 13px;
      background: #f3f4f6;
      color: #6b7280;
    }

    .step-item.done {
      background: #ecfdf5;
      color: #047857;
    }

    .step-item.fail {
      background: #fee2e2;
      color: #b91c1c;
      font-weight: 600;
    }

    main {
      max-width: 960px;
      margin: 40px auto;
      padding: 0 20px;
    }

    .page-title {
      font-size: 26px;
      font-weight: 600;
      margin-bottom: 6px;
    }

    .page-desc {
      color: #6b7280;
      margin-bottom: 28px;
    }

    .card {
      background: #ffffff;
      border-radius: 12px;
      padding: 24px;
      margin-bottom: 20px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.04);
    }

    .badge-fail {
      display: inline-block;
      background: #fee2e2;
      color: #b91c1c;
      padding: 6px 12px;
      border-radius: 999px;
      font-size: 13px;
      font-weight: 600;
      margin-bottom: 12px;
    }

    .summary {
      font-size: 15px;
      line-height: 1.6;
      color: #374151;
    }

    .compare {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
      margin-top: 16px;
    }

    .box {
      background: #f9fafb;
      border-radius: 10px;
      padding: 16px;
      font-size: 14px;
    }

    .box h4 {
      margin: 0 0 8px 0;
      font-size: 14px;
    }

    .expected { color: #047857; }
    .actual { color: #b91c1c; }

    .ai-guide {
      background: #eff6ff;
      border-left: 4px solid #2563eb;
      padding: 16px;
      border-radius: 8px;
      font-size: 14px;
      color: #1e3a8a;
      line-height: 1.6;
    }

    .actions {
      display: flex;
      gap: 12px;
      justify-content: flex-end;
      margin-top: 32px;
    }

    button {
      padding: 10px 16px;
      border-radius: 8px;
      border: none;
      cursor: pointer;
      font-size: 14px;
    }

    .btn-secondary {
      background: #e5e7eb;
      color: #374151;
    }

    .btn-primary {
      background: #2563eb;
      color: #ffffff;
    }

    /* 실행 요약 KPI 카드 */
.summary-grid {
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 16px;
  margin-top: 16px;
}

.summary-item {
  background: #f9fafb;
  border-radius: 12px;
  padding: 16px;
  text-align: center;
}

.summary-item .label {
  font-size: 13px;
  color: #6b7280;
  margin-bottom: 6px;
}

.summary-item .value {
  font-size: 22px;
  font-weight: 700;
}

.summary-item.success .value {
  color: #047857;
}

.summary-item.warn .value {
  color: #d97706;
}

.summary-item.fail .value {
  color: #b91c1c;
}
  </style>
</head>

<body>

<header>
  <h1>AI QA Platform</h1>
  <span>STEP 4 · QA 실패</span>
</header>

<div class="step-bar">
  <div class="step-item done">① 시나리오 업로드</div>
  <div class="step-item done">② AI QA 실행</div>
  <div class="step-item done">③ 실행 중</div>
  <div class="step-item fail">④ 결과</div>
</div>

<main>
  <div class="page-title">QA 실행 결과</div>
  <div class="page-desc">
    AI가 테스트 시나리오를 끝까지 실행했으며,<br />
    아래 단계에서 기대 결과를 충족하지 못했습니다.
  </div>

  <!-- 실행 요약 -->
<div class="card">
  <h3 style="margin-top:0;">실행 요약</h3>
  <div class="summary-grid">
  <div class="summary-item">
    <div class="label">총 Step 수</div>
    <div class="value" id="summaryTotalSteps"></div>
  </div>

  <div class="summary-item success">
    <div class="label">성공</div>
    <div class="value">35</div>
  </div>

  <div class="summary-item warn">
    <div class="label">오류 (진행 가능)</div>
    <div class="value">5</div>
  </div>

  <div class="summary-item fail">
    <div class="label">실패 (중단)</div>
    <div class="value">1</div>
  </div>
</div>

  <div style="margin-top:16px;">
    <button class="btn-primary"
  onclick="location.href='ai_running.html?mode=result&runID=HW-003'">
  QA 실행 상세 이력 보기
</button>
  </div>
</div>

  <!-- 실패 요약 -->
  <div class="card">
    <div class="badge-fail">❌ QA 실패</div>
    <div class="summary">
      <strong>실패 시나리오:</strong> <span id="failScenarioName"></span><br />
      <strong>실패 단계:</strong> 입력값 검증 및 오류 메시지 확인<br />
      <strong>실패 유형:</strong> 기대한 오류 메시지 미노출

      <script>
document.getElementById("failScenarioName").textContent =
  localStorage.getItem("scenarioFileName") || "시나리오 정보 없음";
</script>
    </div>
  </div>

  <!-- 기대 결과 vs 실제 결과 -->
  <div class="card">
    <h3 style="margin-top:0;">실패 지점 상세</h3>
    <div class="compare">
      <div class="box">
        <h4 class="expected">기대 결과</h4>
        제목을 입력하지 않았을 경우<br />
        “필수 입력 항목입니다” 오류 메시지가 표시됨
      </div>
      <div class="box">
        <h4 class="actual">실제 결과</h4>
        오류 메시지가 표시되지 않고<br />
        과제 생성이 계속 진행됨
      </div>
    </div>
  </div>

  <!-- AI 가이드 -->
  <div class="card">
    <h3 style="margin-top:0;">AI 개선 가이드</h3>
    <div class="ai-guide">
      · 기대 결과에 <strong>오류 메시지 노출 여부</strong>를 명확히 포함해 주세요.<br />
      · 오류 검증이 프론트엔드 / 백엔드 중 어디에서 처리되는지 구분하면 정확도가 높아집니다.<br />
      · 오류 메시지의 정확한 문구를 명시하면 자동 판별이 쉬워집니다.
    </div>
  </div>

  <!-- 액션 -->
  <div class="actions">
    <button class="btn-secondary" onclick="location.href='index.html'">
      시나리오 수정
    </button>
    <button class="btn-primary" onclick="location.href='ai_running.html'">
      다시 실행
    </button>

    <button class="btn-primary" onclick="createJiraIssue()">
     Jira 이슈 생성
    </button>
   <button class="btn-primary" onclick="downloadReport()">
     리포트 다운로드
   </button>
  </div>
</main>

<script>
  function createJiraIssue() {
  const scenarioName =
    sessionStorage.getItem("scenarioName") || "시나리오 정보 없음";

  alert(`
Jira 이슈가 생성되었습니다.

• 시나리오: ${scenarioName}
• 실패 단계: 입력값 검증
• 유형: 오류 메시지 미노출
`);
}

  function downloadReport() {
  const scenarioName =
    sessionStorage.getItem("scenarioName") || "시나리오 정보 없음";

  const report = `
[AI QA 실행 결과 리포트]

시나리오: ${scenarioName}
결과: 실패

실패 단계:
- 입력값 검증 및 오류 메시지 확인

기대 결과:
- 제목 미입력 시 '필수 입력 항목입니다' 메시지 노출

실제 결과:
- 오류 메시지 노출되지 않음

AI 개선 가이드:
- 오류 메시지 노출 여부를 기대 결과에 명확히 포함
- 검증 위치(프론트/백엔드) 구분 권장
`;

  const blob = new Blob([report], { type: "text/plain;charset=utf-8;" });
  const url = URL.createObjectURL(blob);

  const a = document.createElement("a");
  a.href = url;
  a.download = "AI_QA_실패_리포트.txt";
  a.click();

  URL.revokeObjectURL(url);
}

document.getElementById("summaryTotalSteps").textContent =
  localStorage.getItem("totalStepCount") || "-";
</script>
</body>
</html>
