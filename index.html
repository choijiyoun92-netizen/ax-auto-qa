<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>AI QA Platform â€“ QA ì‹œë‚˜ë¦¬ì˜¤ ì—…ë¡œë“œ</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>

  <style>
    * { box-sizing: border-box; }

    body {
      margin: 0;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
      background: #f4f6f9;
      color: #222;
    }

    header {
      background: #ffffff;
      padding: 16px 24px;
      border-bottom: 1px solid #e5e7eb;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    header h1 {
      font-size: 18px;
      margin: 0;
    }

    header span {
      font-size: 13px;
      color: #6b7280;
    }

    main {
      max-width: 960px;
      margin: 40px auto;
      padding: 0 20px;
    }

    .page-title {
      font-size: 24px;
      font-weight: 600;
      margin-bottom: 8px;
    }

    .page-desc {
      color: #6b7280;
      margin-bottom: 32px;
    }

    /* ì—…ë¡œë“œ ì˜ì—­ */
    .upload-box {
      background: #ffffff;
      border: 2px dashed #cbd5e1;
      border-radius: 12px;
      padding: 40px;
      text-align: center;
      cursor: pointer;
      transition: background 0.2s, border-color 0.2s;
    }

    .upload-box:hover {
      background: #f9fafb;
      border-color: #94a3b8;
    }

    .upload-box strong {
      display: block;
      font-size: 16px;
      margin-bottom: 8px;
    }

    .upload-box span {
      font-size: 14px;
      color: #6b7280;
    }

    /* ê²°ê³¼ ìš”ì•½ */
    .result-section {
      margin-top: 32px;
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 16px;
    }

    .summary-card {
      background: #ffffff;
      border-radius: 12px;
      padding: 20px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.04);
    }

    .summary-card h3 {
      margin: 0 0 8px 0;
      font-size: 14px;
      color: #6b7280;
    }

    .summary-card p {
      font-size: 22px;
      font-weight: 600;
      margin: 0;
    }

    /* âš ï¸ AI í•™ìŠµ ê²€ì¦ ê²½ê³  ì˜ì—­ */
    .validation-card {
      margin-top: 24px;
      border-radius: 12px;
      padding: 20px 24px;
      background: #fff7ed;
      border: 1px solid #fed7aa;
    }

    .validation-header {
      display: flex;
      align-items: center;
      gap: 8px;
      font-weight: 600;
      margin-bottom: 8px;
      color: #c2410c;
    }

    .validation-desc {
      font-size: 14px;
      color: #7c2d12;
      margin-bottom: 12px;
    }

    .validation-list {
      padding-left: 18px;
      margin: 0;
      font-size: 14px;
      color: #7c2d12;
    }

    .validation-list li {
      margin-bottom: 6px;
    }

    .validation-tip {
      margin-top: 12px;
      font-size: 13px;
      color: #92400e;
    }

    /* AI í•´ì„ ì¹´ë“œ */
    .ai-card {
      margin-top: 24px;
      background: #ffffff;
      border-radius: 12px;
      padding: 24px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.04);
    }

    .ai-card h2 {
      font-size: 16px;
      margin: 0 0 12px 0;
    }

    .ai-card ul {
      padding-left: 18px;
      margin: 0;
      color: #374151;
    }

    .ai-card li {
      margin-bottom: 6px;
      font-size: 14px;
    }

    /* í•˜ë‹¨ CTA */
    .cta {
      margin-top: 32px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .cta span {
      font-size: 13px;
      color: #92400e;
    }

    .cta button {
      background: #2563eb;
      color: #ffffff;
      border: none;
      border-radius: 10px;
      padding: 14px 20px;
      font-size: 15px;
      cursor: pointer;
    }

    .cta button:hover {
      background: #1e40af;
    }

    footer {
      text-align: center;
      font-size: 12px;
      color: #9ca3af;
      margin: 40px 0 20px;
    }

    /* STEP ì§„í–‰ ë°” */
    .step-bar {
      max-width: 960px;
      margin: 24px auto 0;
      padding: 0 20px;
      display: flex;
      gap: 12px;
    }

    .step-item {
      flex: 1;
      padding: 10px 12px;
      border-radius: 999px;
      text-align: center;
      font-size: 13px;
      background: #f3f4f6;
      color: #6b7280;
    }

    .step-item a {
      color: inherit;
      text-decoration: none;
    }

    .step-item.done {
      background: #ecfdf5;
      color: #047857;
    }

    .step-item.active {
      background: #2563eb;
      color: #ffffff;
      font-weight: 600;
    }

    /* ë“œë˜ê·¸ ì¤‘ ê°•ì¡° ìƒíƒœ */
    .upload-box.dragover {
     background: #eff6ff;
     border-color: #2563eb;
    }

    /* =========================
   ìš”ì•½ ì¹´ë“œ íˆ´íŒ
========================= */
.summary-title {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  position: relative;
}

.tooltip-icon {
  width: 16px;
  height: 16px;
  border-radius: 50%;
  background: #e5e7eb;
  color: #374151;
  font-size: 11px;
  font-weight: 600;
  line-height: 16px;
  text-align: center;
  cursor: default;
}

.tooltip-box {
  position: absolute;
  top: 24px;
  left: 0;
  width: 260px;
  padding: 10px 12px;
  background: #111827;
  color: #ffffff;
  font-size: 12px;
  line-height: 1.5;
  border-radius: 8px;
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.15s ease;
  z-index: 10;
}

.summary-title:hover .tooltip-box {
  opacity: 1;
}

/* =========================
   AI ê²€í†  í•„ìš” Step ìƒì„¸
========================= */

.summary-card p {
  cursor: default;
}

.ai-review-detail {
  margin-top: 12px;
  padding-top: 12px;
  border-top: 1px dashed #e5e7eb;
  font-size: 13px;
}

.ai-review-list {
  list-style: none;
  padding: 0;
  margin: 0 0 12px 0;
}

.ai-review-list li {
  margin-bottom: 8px;
}

.ai-review-list strong {
  display: inline-block;
  width: 80px;
  color: #111827;
}

.ai-review-desc {
  display: block;
  margin-left: 80px;
  color: #6b7280;
  font-size: 12px;
}

.ai-review-mapping {
  background: #f9fafb;
  border-radius: 8px;
  padding: 10px 12px;
  font-size: 12px;
  color: #374151;
}

.ai-review-mapping ul {
  padding-left: 16px;
  margin: 6px 0 0;
}

/* =========================
   Step ë¯¸ë¦¬ë³´ê¸° ì¹´ë“œ
========================= */

.review-group {
  margin-top: 16px;
}

.review-group-title {
  font-size: 14px;
  font-weight: 600;
  margin-bottom: 8px;
  color: #111827;
}

.step-card {
  border: 1px solid #e5e7eb;
  border-radius: 10px;
  margin-bottom: 10px;
  overflow: hidden;
  background: #ffffff;
}

.step-card-header {
  padding: 10px 14px;
  display: flex;
  justify-content: space-between;
  align-items: center;
  cursor: pointer;
  font-size: 13px;
  font-weight: 600;
  background: #f9fafb;
}

.step-card-header:hover {
  background: #f3f4f6;
}

.toggle-icon {
  font-size: 12px;
  color: #6b7280;
}

.step-card-body {
  padding: 12px 14px;
  display: none;
}

.step-card.open .step-card-body {
  display: block;
}

.step-card.open .toggle-icon {
  transform: rotate(180deg);
}

/* ì—‘ì…€ í…Œì´ë¸” ì¬ì‚¬ìš© */
.excel-table {
  width: 100%;
  border-collapse: collapse;
  font-size: 12px;
  margin-bottom: 8px;
}

.excel-table th,
.excel-table td {
  border: 1px solid #e5e7eb;
  padding: 6px 8px;
  text-align: left;
}

.excel-table th {
  background: #f9fafb;
  font-weight: 600;
}

.excel-warning {
  font-size: 12px;
  color: #b45309;
}
  </style>
</head>

<body>

  <header>
    <h1>AI QA Platform</h1>
    <span>STEP 1 Â· QA ì‹œë‚˜ë¦¬ì˜¤ ì—…ë¡œë“œ</span>
  </header>

  <div class="step-bar">
  <div class="step-item active">
     â‘  ì‹œë‚˜ë¦¬ì˜¤ ì—…ë¡œë“œ
  </div>
  <div class="step-item">
     â‘¡ AI QA ì‹¤í–‰
  </div>
  <div class="step-item">
     â‘¢ ì‹¤í–‰ ì¤‘
  </div>
  </div>

  <main>
    <div class="page-title">QA ì‹œë‚˜ë¦¬ì˜¤ ì—…ë¡œë“œ</div>
    <div class="page-desc">
      ê¸°ì¡´ì— ì‚¬ìš©í•˜ë˜ ì—‘ì…€ í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤ë¥¼ ì—…ë¡œë“œí•˜ë©´,<br />
      AIê°€ QA ì‹¤í–‰ì— í™œìš©í•  ìˆ˜ ìˆë„ë¡ êµ¬ì¡°í™”í•©ë‹ˆë‹¤.
    </div>

    <div class="upload-box" id="uploadBox">
     <strong>ì—‘ì…€ íŒŒì¼ì„ ì—¬ê¸°ì— ë“œë˜ê·¸ ì•¤ ë“œë¡­</strong>
     <span>.xlsx íŒŒì¼ë§Œ ì—…ë¡œë“œ ê°€ëŠ¥</span>
     <input type="file" id="fileInput" accept=".xlsx" hidden />
    </div>

    <!-- ì—…ë¡œë“œ ì™„ë£Œ í›„ ìš”ì•½ -->
    <section class="result-section" id="resultSection" style="display:none;">
      <div class="summary-card">
  <h3 class="summary-title">
    ì´ Step ìˆ˜
    <span class="tooltip-icon">i</span>
    <span class="tooltip-box">
      ì—…ë¡œë“œí•œ ì—‘ì…€ ì‹œë‚˜ë¦¬ì˜¤ì—ì„œ<br />
      <strong>[ìˆœì„œ]</strong> ì»¬ëŸ¼ì„ ê¸°ì¤€ìœ¼ë¡œ<br />
      AIê°€ ì¸ì‹í•œ ì „ì²´ ì‹¤í–‰ ë‹¨ê³„ ìˆ˜ì…ë‹ˆë‹¤.
    </span>
  </h3>
  <p id="totalStepCount">-</p>
</div>

      <div class="summary-card">
  <h3 class="summary-title">
    í…ŒìŠ¤íŠ¸ ë²”ìœ„
    <span class="tooltip-icon">i</span>
    <span class="tooltip-box">
      ì—…ë¡œë“œí•œ í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤ê°€<br />
      ê²€ì¦í•˜ë ¤ëŠ” ê¸°ëŠ¥ ë˜ëŠ” ì—…ë¬´ ë²”ìœ„ì…ë‹ˆë‹¤.<br /><br />
      í˜„ì¬ëŠ” ì—‘ì…€ 1ê°œ ê¸°ì¤€ìœ¼ë¡œ ë¶„ì„ë©ë‹ˆë‹¤.
    </span>
  </h3>
  <p>ê³¼ì œ ìƒì„± ë° ë°°í¬</p>
</div>

      <div class="summary-card">
  <h3 class="summary-title">
    AI ê²€í†  í•„ìš” Step
    <span class="tooltip-icon">i</span>
    <span class="tooltip-box">
      AIê°€ ì„±ê³µ/ì‹¤íŒ¨ë¥¼ ìë™ íŒë‹¨í•˜ê¸°<br />
      ì–´ë ¤ìš´ ë‹¨ê³„ ìˆ˜ì…ë‹ˆë‹¤.<br /><br />
      ì˜ˆ:<br />
      â— ìˆ˜ì • í•„ìš” â†’ ê¸°ëŒ€ ê²°ê³¼ ë¯¸ì •ì˜<br />
      â— ë¶„ì„ ë¶ˆê°€ â†’ í–‰ìœ„/ì£¼ì²´ ìì²´ ë¶ˆëª…í™•<br />
      â— ë³´ì™„ í•„ìš” â†’ íŒë‹¨ ê¸°ì¤€ ë¶€ì¡±<br />
    </span>
  </h3>
  <p>5ê°œ</p>
  <!-- AI ê²€í†  í•„ìš” Step ìƒì„¸ -->
<div class="ai-review-detail">

  <div class="review-group">
    <div class="review-group-title">ğŸ”§ ìˆ˜ì • í•„ìš” (2ê°œ)</div>

    <!-- Step ì¹´ë“œ -->
    <div class="step-card">
      <div class="step-card-header">
        <span>Step 12</span>
        <span class="toggle-icon">â–¼</span>
      </div>

      <div class="step-card-body">
        <table class="excel-table">
          <thead>
            <tr>
              <th>ìˆœì„œ</th>
              <th>ë™ì‘ ì„¤ëª…</th>
              <th>ë©”ëª¨</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>12</td>
              <td>ê³¼ì œ ì €ì¥ ë²„íŠ¼ í´ë¦­</td>
              <td></td>
            </tr>
          </tbody>
        </table>

        <div class="excel-warning">
          âš  ë™ì‘ ê²°ê³¼ê°€ ëª…í™•í•˜ì§€ ì•Šì•„ ì„±ê³µ/ì‹¤íŒ¨ íŒë‹¨ì´ ì–´ë µìŠµë‹ˆë‹¤.
        </div>
      </div>
    </div>

    <div class="step-card">
      <div class="step-card-header">
        <span>Step 27</span>
        <span class="toggle-icon">â–¼</span>
      </div>

      <div class="step-card-body">
        <table class="excel-table">
          <thead>
            <tr>
              <th>ìˆœì„œ</th>
              <th>ë™ì‘ ì„¤ëª…</th>
              <th>ë©”ëª¨</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>27</td>
              <td>ë°°í¬ ì™„ë£Œ í™•ì¸</td>
              <td>ì •ìƒ ë…¸ì¶œ</td>
            </tr>
          </tbody>
        </table>

        <div class="excel-warning">
          âš  ê¸°ëŒ€ ê²°ê³¼ê°€ ì¶”ìƒì ìœ¼ë¡œ ì‘ì„±ë˜ì–´ ìˆìŠµë‹ˆë‹¤.
        </div>
      </div>
    </div>

  </div>

  <div class="review-group">
  <div class="review-group-title">â“ ë¶„ì„ ë¶ˆê°€ (1ê°œ)</div>

  <div class="step-card">
    <div class="step-card-header">
      <span>Step 18</span>
      <span class="toggle-icon">â–¼</span>
    </div>

    <div class="step-card-body">
      <table class="excel-table">
        <thead>
          <tr>
            <th>ìˆœì„œ</th>
            <th>ë™ì‘ ì„¤ëª…</th>
            <th>ë©”ëª¨</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>18</td>
            <td>ì‹œìŠ¤í…œ ì²˜ë¦¬</td>
            <td></td>
          </tr>
        </tbody>
      </table>

      <div class="excel-warning">
        âš  ë™ì‘ ì£¼ì²´ì™€ ê²°ê³¼ê°€ ëª…ì‹œë˜ì§€ ì•Šì•„ AIê°€ ì‹¤í–‰ íë¦„ì„ í•´ì„í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.
      </div>
    </div>
  </div>
</div>

<div class="review-group">
  <div class="review-group-title">ğŸ§© ë³´ì™„ í•„ìš” (2ê°œ)</div>

  <div class="step-card">
    <div class="step-card-header">
      <span>Step 33</span>
      <span class="toggle-icon">â–¼</span>
    </div>

    <div class="step-card-body">
      <table class="excel-table">
        <thead>
          <tr>
            <th>ìˆœì„œ</th>
            <th>ë™ì‘ ì„¤ëª…</th>
            <th>ë©”ëª¨</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>33</td>
            <td>ê³¼ì œ ëª©ë¡ í™•ì¸</td>
            <td></td>
          </tr>
        </tbody>
      </table>

      <div class="excel-warning">
        âš  í™•ì¸ ê¸°ì¤€ì´ ì—†ì–´ ê²°ê³¼ íŒë‹¨ ì¡°ê±´ì„ ë³´ì™„í•  í•„ìš”ê°€ ìˆìŠµë‹ˆë‹¤.
      </div>
    </div>
  </div>

  <div class="step-card">
    <div class="step-card-header">
      <span>Step 41</span>
      <span class="toggle-icon">â–¼</span>
    </div>

    <div class="step-card-body">
      <table class="excel-table">
        <thead>
          <tr>
            <th>ìˆœì„œ</th>
            <th>ë™ì‘ ì„¤ëª…</th>
            <th>ë©”ëª¨</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>41</td>
            <td>í•™ìƒ í™”ë©´ ì ‘ê·¼</td>
            <td>ì •ìƒ ì—¬ë¶€ í™•ì¸</td>
          </tr>
        </tbody>
      </table>

      <div class="excel-warning">
        âš  â€˜ì •ìƒâ€™ì˜ ê¸°ì¤€ì´ ëª¨í˜¸í•˜ì—¬ AI ìë™ íŒë³„ì´ ì–´ë µìŠµë‹ˆë‹¤.
      </div>
    </div>
  </div>
</div>

</div>

    </section>

    <!-- âš ï¸ AI í•™ìŠµ ì í•©ì„± ê²½ê³  -->
    <div class="validation-card" id="validationCard" style="display:none;">
      <div class="validation-header">
        âš ï¸ AI í•™ìŠµ ì í•©ì„± ì ê²€ ê²°ê³¼
      </div>
      <div class="validation-desc">
        ì¼ë¶€ ì‹œë‚˜ë¦¬ì˜¤ëŠ” AIê°€ ì •í™•íˆ ì´í•´í•˜ê¸° ì–´ë ¤ìš´ í˜•ì‹ì…ë‹ˆë‹¤.
      </div>
      <ul class="validation-list">
        <li>â€˜ê¸°ëŒ€ ê²°ê³¼â€™ í•­ëª©ì´ ë¹„ì–´ ìˆëŠ” ì‹œë‚˜ë¦¬ì˜¤ê°€ 6ê°œ ìˆìŠµë‹ˆë‹¤.</li>
        <li>í…ŒìŠ¤íŠ¸ ë‹¨ê³„ê°€ í•œ ì…€ì— ë¬¸ë‹¨ í˜•íƒœë¡œ ì‘ì„±ëœ ê²½ìš°ê°€ ìˆìŠµë‹ˆë‹¤.</li>
        <li>ê¸°ëŠ¥ ì˜ì—­ëª…ì´ ì¼ê´€ë˜ì§€ ì•Šì•„ ê·¸ë£¹í™”ì— ì œí•œì´ ìˆìŠµë‹ˆë‹¤.</li>
      </ul>
      <div class="validation-tip">
        ğŸ’¡ ê¶Œì¥: â€˜í…ŒìŠ¤íŠ¸ ë‹¨ê³„ / ê¸°ëŒ€ ê²°ê³¼ / ì‹¤íŒ¨ ê¸°ì¤€â€™ì„ ë¶„ë¦¬í•˜ë©´ AI QA ì •í™•ë„ê°€ ë†’ì•„ì§‘ë‹ˆë‹¤.
      </div>
    </div>

    <div class="ai-card" id="aiCard" style="display:none;">
      <h2>ğŸ¤– AIê°€ ì´ë ‡ê²Œ ì´í•´í–ˆì–´ìš”</h2>
      <ul>
        <li>ê³¼ì œ ìƒì„±/ìˆ˜ì • ê¸°ëŠ¥ì— ëŒ€í•œ í…ŒìŠ¤íŠ¸ ë¹„ì¤‘ì´ ë†’ìŠµë‹ˆë‹¤.</li>
        <li>êµì‚¬ ê¶Œí•œ ê¸°ì¤€ ì‹œë‚˜ë¦¬ì˜¤ê°€ ì „ì²´ì˜ 65%ë¥¼ ì°¨ì§€í•©ë‹ˆë‹¤.</li>
        <li>ì…ë ¥ê°’ ê²€ì¦ ê´€ë ¨ ì‹¤íŒ¨ ì¼€ì´ìŠ¤ê°€ ë°˜ë³µì ìœ¼ë¡œ ë“±ì¥í•©ë‹ˆë‹¤.</li>
      </ul>
    </div>

    <div class="cta">
      <span>â€» AI ê²€í†  í•„ìš” Stepì´ ìˆì–´ë„ AI QA ì‹¤í–‰ì€ ê°€ëŠ¥í•©ë‹ˆë‹¤.</span>
         <button id="runAiQaBtn">AI QA ì‹¤í–‰í•˜ê¸° â†’</button>
    </div>
  </main>

  <footer>
    Â© 2026 AI QA Platform. Internal QA Tool.
  </footer>

  <script>
  const uploadBox = document.getElementById("uploadBox");
  const fileInput = document.getElementById("fileInput");
  const resultSection = document.getElementById("resultSection");
  const validationCard = document.getElementById("validationCard");
  const aiCard = document.getElementById("aiCard");

  /* =========================
     1. í´ë¦­ ì—…ë¡œë“œ (ê¸°ì¡´)
  ========================= */
  uploadBox.addEventListener("click", () => fileInput.click());

  /* =========================
     2. ë“œë˜ê·¸ ì•¤ ë“œë¡­ ì²˜ë¦¬
  ========================= */

  // ê¸°ë³¸ ë™ì‘ ë°©ì§€ (ë¸Œë¼ìš°ì €ê°€ íŒŒì¼ ì—´ì–´ë²„ë¦¬ëŠ” ê²ƒ ë°©ì§€)
  ["dragenter", "dragover", "dragleave", "drop"].forEach(eventName => {
    uploadBox.addEventListener(eventName, e => {
      e.preventDefault();
      e.stopPropagation();
    });
  });

  // ë“œë˜ê·¸ ì¤‘ UI ê°•ì¡°
  ["dragenter", "dragover"].forEach(eventName => {
    uploadBox.addEventListener(eventName, () => {
      uploadBox.classList.add("dragover");
    });
  });

  ["dragleave", "drop"].forEach(eventName => {
    uploadBox.addEventListener(eventName, () => {
      uploadBox.classList.remove("dragover");
    });
  });

  // íŒŒì¼ ë“œë¡­ ì‹œ
  uploadBox.addEventListener("drop", e => {
    const files = e.dataTransfer.files;
    if (!files || files.length === 0) return;

    // inputì— íŒŒì¼ ì£¼ì…
    fileInput.files = files;

    // ê¸°ì¡´ change ë¡œì§ ì¬ì‚¬ìš©
    handleFileUpload(files[0]);
  });

  /* =========================
     3. íŒŒì¼ ì„ íƒ í›„ ì²˜ë¦¬
  ========================= */

  fileInput.addEventListener("change", () => {
    const file = fileInput.files[0];
    if (!file) return;
    handleFileUpload(file);
  });

  function handleFileUpload(file) {
  // ì´ˆê¸°í™”
  resultSection.style.display = "none";
  validationCard.style.display = "none";
  aiCard.style.display = "none";

  uploadBox.querySelector("strong").innerText = "ì—…ë¡œë“œ ì¤‘ì…ë‹ˆë‹¤...";
  uploadBox.querySelector("span").innerText = "AIê°€ ì‹œë‚˜ë¦¬ì˜¤ë¥¼ ë¶„ì„í•˜ê³  ìˆì–´ìš”";

  const reader = new FileReader();

  reader.onload = function (e) {
    const data = new Uint8Array(e.target.result);
    const workbook = XLSX.read(data, { type: "array" });

    // ì²« ë²ˆì§¸ ì‹œíŠ¸ ì‚¬ìš©
    const sheetName = workbook.SheetNames[0];
    const worksheet = workbook.Sheets[sheetName];

    // JSON ë³€í™˜ (A6ë¶€í„°)
const rows = XLSX.utils.sheet_to_json(worksheet, {
  range: 5,
  defval: ""
});

window.__debugRows = rows;

// rows ë°©ì–´ ì²˜ë¦¬
if (!rows.length) {
  document.getElementById("totalStepCount").innerText = "0ê°œ";
  return;
}

// âœ… [ìˆœì„œ] ì»¬ëŸ¼ í‚¤ ì°¾ê¸°
const orderKey = Object.keys(rows[0]).find(key =>
  key.replace(/\s/g, "") === "ìˆœì„œ"
);

if (!orderKey) {
  console.warn("ìˆœì„œ ì»¬ëŸ¼ì„ ì°¾ì§€ ëª»í–ˆìŠµë‹ˆë‹¤.", rows[0]);
  document.getElementById("totalStepCount").innerText = "0ê°œ";
  return;
}

// Step ìˆ˜ ê³„ì‚°
const stepSet = new Set();

rows.forEach(row => {
  const value = Number(row[orderKey]);
  if (Number.isInteger(value)) {
    stepSet.add(value);
  }
});

const stepCount = stepSet.size;

// âœ… í˜ì´ì§€ ê°„ ê³µìœ  ë°ì´í„° ì €ì¥
localStorage.setItem("scenarioFileName", file.name);
localStorage.setItem("totalStepCount", stepCount);

// UI ë°˜ì˜
document.getElementById("totalStepCount").innerText = `${stepCount}ê°œ`;

    // ì—…ë¡œë“œ ì™„ë£Œ UI
    uploadBox.querySelector("strong").innerText = "ì—…ë¡œë“œ ì™„ë£Œ";
    uploadBox.querySelector("span").innerText = file.name;

    resultSection.style.display = "grid";
    aiCard.style.display = "block";

    // ë”ë¯¸ ê²€ì¦ ë¡œì§ ìœ ì§€
    const isInvalid =
      file.name.toLowerCase().includes("bad") ||
      file.name.toLowerCase().includes("fail") ||
      file.name.toLowerCase().includes("error");

    if (isInvalid) {
      validationCard.style.display = "block";
    }
  };

  reader.readAsArrayBuffer(file);
}

  /* =========================
     4. STEP 2 ì´ë™
  ========================= */
  const runBtn = document.getElementById("runAiQaBtn");

  runBtn.addEventListener("click", () => {
  const file = fileInput.files[0];

  if (!file) {
    alert("íŒŒì¼ì„ ì—…ë¡œë“œí•´ì£¼ì„¸ìš”.");
    return;
  }

  // âœ… ì—¬ê¸°ì„œ ë°˜ë“œì‹œ ì €ì¥
  sessionStorage.setItem("scenarioName", file.name);

  // (ì„ íƒ) ë‚˜ì¤‘ì— í™•ì¥ìš©
  sessionStorage.setItem("runStartedAt", Date.now());

  window.location.href = "ai_run.html";
});

  /* =========================
   Step ì¹´ë“œ í† ê¸€
========================= */
document.querySelectorAll(".step-card-header").forEach(header => {
  header.addEventListener("click", () => {
    const card = header.parentElement;
    card.classList.toggle("open");
  });
});
</script>

</body>
</html>
